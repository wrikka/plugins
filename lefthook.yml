pre-commit:
  jobs:
    - name: install-deps
      run: bun install
    - name: format
      run: bun run format {staged_files}


pre-rebase:
  jobs:
    - name: fetch-origin
      run: git fetch origin
    - name: rebase-check
      run: |
        LOCAL=$(git rev-parse @)
        REMOTE=$(git rev-parse @{u})
        BASE=$(git merge-base @ @{u})
        [ "$LOCAL" = "$REMOTE" ] && exit 0
        [ "$LOCAL" = "$BASE" ] && { echo "Branch behind, pull/rebase first!"; exit 1; }

post-receive:
  jobs:
    - name: open repo
      run: gh repo view --web

post-checkout:
  jobs:
    - name: install-deps
      run: bun install